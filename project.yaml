######################################
# Script defines project pipeline via series of actions
######################################

version: '3.0'

expectations:
  population_size: 250000

actions:

#############################
### Import/processing for coverage population
#############################

  # Extract data ----
  generate_study_population:
    run: cohortextractor:latest generate_cohort --study-definition study_definition --output-dir=output/data
    outputs:
      highly_sensitive:
        cohort: output/data/input.csv
  
  # Process data ----
  data_process:
    run: r:latest analysis/data_process.R
    needs: [generate_study_population]
    outputs:
      highly_sensitive:
        data: output/data/data_processed.rds
        csv: output/data/data_processed.csv
       
  # Data properties (processed) ----
  data_properties_process:
    run: r:latest analysis/data_properties.R output/data/data_processed.rds output/data_properties
    needs: [data_process]
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_processed*.txt

#############################
### Import/processing for primary VE cohort
#############################

  # Extract data - primary VE ----
  generate_study_population_VE_primary:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_VE_primary --output-dir=output/data
    outputs:
      highly_sensitive:
        cohort: output/data/input_VE_primary.csv

  # Process data - primary VE ----
  data_process_VE_primary:
    run: r:latest analysis/data_process_VE_primary.R
    needs: [generate_study_population_VE_primary]
    outputs:
      highly_sensitive:
        data: output/data/data_processed_VE_primary.rds
        csv: output/data/data_processed_VE_primary.csv
       
  # Data properties (processed) - primary VE ----
  data_properties_process_VE_primary:
    run: r:latest analysis/data_properties.R output/data/data_processed_VE_primary.rds output/data_properties
    needs: [data_process_VE_primary]
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_processed_VE_primary*.txt

#############################
### Import/processing for booster VE cohort
#############################

  # Extract data - booster VE ----
  generate_study_population_VE_boost:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_VE_boost --output-dir=output/data
    outputs:
      highly_sensitive:
        cohort: output/data/input_VE_boost.csv

  # Process data - booster VE ----
  data_process_VE_boost:
    run: r:latest analysis/data_process_VE_boost.R
    needs: [generate_study_population_VE_boost]
    outputs:
      highly_sensitive:
        data: output/data/data_processed_VE_boost.rds
        csv: output/data/data_processed_VE_boost.csv
       
  # Data properties (processed) - booster VE ----
  data_properties_process_VE_boost:
    run: r:latest analysis/data_properties.R output/data/data_processed_VE_boost.rds output/data_properties
    needs: [data_process_VE_boost]
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_processed_VE_boost*.txt

#############################
### Coverage analyses
#############################

  # Select cohort ----
  data_selection_coverage:
    run: r:latest analysis/coverage/data_selection_coverage.R
    needs: [data_process]
    outputs:
      highly_sensitive:
        data1: output/data/data_cohort_coverage.rds
        csv: output/data/data_cohort_coverage.csv
        data2: output/data/data_cohort_coverage_logistic.rds
        data3: output/data/data_cohort_coverage_dose4.rds
      moderately_sensitive:
        csv: output/tables/flowchart_coverage.csv
  
  # Data properties (coverage) ----
  data_properties_coverage:
    run: r:latest analysis/data_properties.R output/data/data_cohort_coverage.rds output/data_properties
    needs: [data_selection_coverage]
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_cohort_coverage*.txt
        
  # Table 1 primary outcome cohort (dose 3) ----
  table_1_coverage_dose3:
    run: r:latest analysis/coverage/table_1_coverage.R dose3
    needs: [data_selection_coverage]
    outputs:
      highly_sensitive:
        data: output/tables/table1_coverage_redacted_by_CKD.rds
      moderately_sensitive:
        table: output/tables/table1_coverage_redacted_by_CKD.html
        
  # Table 1 primary outcome cohort (dose 3) ----
  table_1_coverage_dose4:
    run: r:latest analysis/coverage/table_1_coverage.R dose4
    needs: [data_selection_coverage]
    outputs:
      highly_sensitive:
        data: output/tables/table1_coverage_redacted_by_CKD_dose4.rds
      moderately_sensitive:
        table: output/tables/table1_coverage_redacted_by_CKD_dose4.html
        
  # Cox models - dose-3 coverage ----
  cox_model_dose3:
    run: r:latest analysis/coverage/cox_model.R dose3
    needs: [data_selection_coverage]
    outputs:
      highly_sensitive:
        data1: output/data/data_cox_coverage_dose3*.rds
        data2: output/model/mod_strat_coxph_redacted_dose3*.rds
      moderately_sensitive:
        csv: output/model/mod_strat_coxph_redacted_dose3*.csv
        
  # Cox models - dose-4 coverage ----
  cox_model_dose4:
    run: r:latest analysis/coverage/cox_model.R dose4
    needs: [data_selection_coverage]
    outputs:
      highly_sensitive:
        data1: output/data/data_cox_coverage_dose4*.rds
        data2: output/model/mod_strat_coxph_redacted_dose4*.rds
      moderately_sensitive:
        csv: output/model/mod_strat_coxph_redacted_dose4*.csv
        
  # Logistic models - dose-3 coverage ----
  logistic_model:
    run: r:latest analysis/coverage/logistic_model.R
    needs: [data_selection_coverage]
    outputs:
      highly_sensitive:
        data1: output/data/data_lr.rds
        data2: output/model/mod_strat_logistic_redacted.rds
      moderately_sensitive:
        csv: output/model/mod_strat_logistic_redacted.csv

  # Coverage summaries ----
  vaccine_coverage:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/vaccine_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown")'
    needs: [data_selection_coverage, table_1_coverage_dose3, table_1_coverage_dose4, cox_model_dose3, cox_model_dose4, logistic_model]
    outputs:
      moderately_sensitive:
        html: output/markdown/vaccine_coverage.html
        
  # Model checks ----
  # Dose 3 - full
  cox_model_check_coverage_dose3_full:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose3_full.html")' dose3 full
    needs: [data_selection_coverage, cox_model_dose3]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose3_full.html
        
  # Dose 3 - CKD3a
  cox_model_check_coverage_dose3_CKD3a:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose3_CKD3a.html")' dose3 CKD3a
    needs: [data_selection_coverage, cox_model_dose3]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose3_CKD3a.html

  # Dose 3 - CKD3b
  cox_model_check_coverage_dose3_CKD3b:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose3_CKD3b.html")' dose3 CKD3b
    needs: [data_selection_coverage, cox_model_dose3]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose3_CKD3b.html

  # Dose 3 - CKD4-5
  cox_model_check_coverage_dose3_CKD4-5:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose3_CKD4-5.html")' dose3 CKD4-5
    needs: [data_selection_coverage, cox_model_dose3]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose3_CKD4-5.html

  # Dose 3 - dialysis
  cox_model_check_coverage_dose3_dialysis:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose3_dialysis.html")' dose3 dialysis
    needs: [data_selection_coverage, cox_model_dose3]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose3_dialysis.html
        
  # Dose 3 - transplant
  cox_model_check_coverage_dose3_transplant:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose3_transplant.html")' dose3 transplant
    needs: [data_selection_coverage, cox_model_dose3]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose3_transplant.html
        
  # Dose 4 - full
  cox_model_check_coverage_dose4_full:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose4_full.html")' dose4 full
    needs: [data_selection_coverage, cox_model_dose4]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose4_full.html
        
  # Dose 4 - CKD3a
  cox_model_check_coverage_dose4_CKD3a:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose4_CKD3a.html")' dose4 CKD3a
    needs: [data_selection_coverage, cox_model_dose4]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose4_CKD3a.html

  # Dose 4 - CKD3b
  cox_model_check_coverage_dose4_CKD3b:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose4_CKD3b.html")' dose4 CKD3b
    needs: [data_selection_coverage, cox_model_dose4]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose4_CKD3b.html

  # Dose 4 - CKD4-5
  cox_model_check_coverage_dose4_CKD4-5:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose4_CKD4-5.html")' dose4 CKD4-5
    needs: [data_selection_coverage, cox_model_dose4]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose4_CKD4-5.html

  # Dose 4 - dialysis
  cox_model_check_coverage_dose4_dialysis:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose4_dialysis.html")' dose4 dialysis
    needs: [data_selection_coverage, cox_model_dose4]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose4_dialysis.html
        
  # Dose 4 - transplant
  cox_model_check_coverage_dose4_transplant:
    run: r:latest -e 'rmarkdown::render("analysis/coverage/cox_model_check_coverage.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/coverage_model_checks/", output_file="dose4_transplant.html")' dose4 transplant
    needs: [data_selection_coverage, cox_model_dose4]
    outputs:
      moderately_sensitive:
        html: output/markdown/coverage_model_checks/dose4_transplant.html

#############################
### VE cohort selection - matched/unmatched
#############################

# Select cohort (single script used for both matched and unmatched analyses)
  data_selection_VE_primary:
    run: r:latest analysis/VE/data_selection_VE_primary.R
    needs: [data_process_VE_primary]
    outputs:
      highly_sensitive:
        data1: output/data/data_cohort_VE_primary.rds
        data2: output/data/data_cohort_VE_primary_matched.rds
        data3: output/lib/outcomes.rds
        data4: output/lib/postvax_list.rds
        csv1: output/data/data_cohort_VE_primary.csv
        csv2: output/data/data_cohort_VE_primary_matched.csv
      moderately_sensitive:
        csv1: output/tables/flowchart_VE_primary.csv
        csv2: output/tables/flowchart_VE_primary_matched.csv

  # Data properties (selected) - primary VE ----
  data_properties_selected_VE_primary:
    run: r:latest analysis/data_properties.R output/data/data_cohort_VE_primary.rds output/data_properties
    needs: [data_selection_VE_primary]
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_cohort_VE_primary*.txt
        
# Descriptive plots of vaccination profile
  vax_dates_VE:
    run: r:latest -e 'rmarkdown::render("analysis/VE/vax_dates_VE.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/")'
    needs: [data_selection_coverage, data_selection_VE_primary, data_selection_VE_boost]
    outputs:
      moderately_sensitive:
        html: output/markdown/vax_dates_VE.html
        
#############################
### VE table 1 - all, CKD3, CKD4-5, RRT, Tx - matched,unmatched
#############################

  # Table 1 (all unmatched)
  table_1_VE_all_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_unmatched_all.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_unmatched_all.html
  
  # Table 1 (CKD3 unmatched)
  table_1_VE_CKD3_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_unmatched_CKD3.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_unmatched_CKD3.html
 
  # Table 1 (CKD4-5 unmatched)
  table_1_VE_CKD4_5_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_unmatched_CKD4-5.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_unmatched_CKD4-5.html
 
  # Table 1 (RRT unmatched)
  table_1_VE_RRT_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_unmatched_RRT.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_unmatched_RRT.html
 
  # Table 1 (Tx unmatched)
  table_1_VE_Tx_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_unmatched_Tx.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_unmatched_Tx.html
        
  # Table 1 (dialysis unmatched)
  table_1_VE_dialysis_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_unmatched_dialysis.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_unmatched_dialysis.html
        
  # Table 1 (all matched)
  table_1_VE_all_matched:
    run: r:latest analysis/VE/table_1_VE.R matched all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_primary_redacted_matched_all.rds
      moderately_sensitive:
        table: output/tables/table1_VE_primary_redacted_matched_all.html

#############################
### IRR - all, CKD3, CKD4-5, RRT - matched,unmatched
#############################
   
  # Table IRR (all unmatched)
  table_irr_unmatched_all:
    run: r:latest analysis/VE/table_irr.R unmatched all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_unmatched_all.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_unmatched_all.csv
        
  # Table IRR (CKD3 unmatched)
  table_irr_unmatched_CKD3:
    run: r:latest analysis/VE/table_irr.R unmatched CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_unmatched_CKD3.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_unmatched_CKD3.csv
 
  # Table IRR (CKD4-5 unmatched)
  table_irr_unmatched_CKD4_5:
    run: r:latest analysis/VE/table_irr.R unmatched CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_unmatched_CKD4-5.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_unmatched_CKD4-5.csv
        
  # Table IRR (RRT unmatched)
  table_irr_unmatched_RRT:
    run: r:latest analysis/VE/table_irr.R unmatched RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_unmatched_RRT.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_unmatched_RRT.csv

  # Table IRR (Tx unmatched)
  table_irr_unmatched_Tx:
    run: r:latest analysis/VE/table_irr.R unmatched Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_unmatched_Tx.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_unmatched_Tx.csv
  
  # Table IRR (dialysis unmatched)
  table_irr_unmatched_dialysis:
    run: r:latest analysis/VE/table_irr.R unmatched dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_unmatched_dialysis.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_unmatched_dialysis.csv
  
  # Table IRR (all matched)
  table_irr_matched_all:
    run: r:latest analysis/VE/table_irr.R matched all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_matched_all.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_matched_all.csv
        
  # Table IRR (CKD3 matched)
  table_irr_matched_CKD3:
    run: r:latest analysis/VE/table_irr.R matched CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_matched_CKD3.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_matched_CKD3.csv
 
  # Table IRR (CKD4-5 matched)
  table_irr_matched_CKD4_5:
    run: r:latest analysis/VE/table_irr.R matched CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_matched_CKD4-5.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_matched_CKD4-5.csv
        
  # Table IRR (RRT matched)
  table_irr_matched_RRT:
    run: r:latest analysis/VE/table_irr.R matched RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_matched_RRT.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_matched_RRT.csv
        
  # Table IRR (Tx matched)
  table_irr_matched_Tx:
    run: r:latest analysis/VE/table_irr.R matched Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_matched_Tx.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_matched_Tx.csv
 
  # Table IRR (dialysis matched)
  table_irr_matched_dialysis:
    run: r:latest analysis/VE/table_irr.R matched dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_primary_redacted_matched_dialysis.rds
      moderately_sensitive:
        csv: output/tables/table_irr_primary_redacted_matched_dialysis.csv
        
  # Table IRR - verification (adapted from prior scripts)
  table_irr_verification:
    run: r:latest analysis/VE/table_irr_verification.R
    needs: [data_selection_VE_primary]
    outputs:
      moderately_sensitive:
        csv: output/tables/table_irr_redacted_verification_unmatched_all.csv

#############################
### Cox models - preflight then model
### Outcomes (4): postest, hosp, death, non-Covid death
### Populations (2): unmatched, matched
### Timescales (3): persontime, calendartime
### Subsets: all, CKD3, CKD4-5, RRT, Tx, dialysis (unmatched)
#############################

### OUTCOME #1: covid_postest test

  ### unmatched persontime all
  # preflight
  cox_preflight_unmatched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_postest_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_postest_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_postest_all.txt
  
  # model
  cox_model_unmatched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_persontime_covid_postest_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_postest_all.txt

  ### matched persontime all
  # preflight
  cox_preflight_matched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime covid_postest all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*matched_persontime_covid_postest_all.rds
        formulas: output/model/VE_primary/formulas*matched_persontime_covid_postest_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_matched_persontime_covid_postest_all.txt
  
  # model
  cox_model_matched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime covid_postest all primary
    needs: [data_selection_VE_primary, table_irr_matched_all, cox_preflight_matched_persontime_covid_postest_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*matched_persontime_covid_postest_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*matched_persontime_covid_postest_all.csv
        logs: output/model/VE_primary/log_cox_model_matched_persontime_covid_postest_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_preflight_unmatched_calendartime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime covid_postest all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_calendartime_covid_postest_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_calendartime_covid_postest_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_calendartime_covid_postest_all.txt
  
  # model
  cox_model_unmatched_calendartime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime covid_postest all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_calendartime_covid_postest_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_calendartime_covid_postest_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_calendartime_covid_postest_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_calendartime_covid_postest_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_preflight_unmatched_persontime_covid_postest_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_postest_CKD3.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_postest_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_postest_CKD3.txt
  
  # model
  cox_model_unmatched_persontime_covid_postest_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest CKD3 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD3, cox_preflight_unmatched_persontime_covid_postest_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_CKD3.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_postest_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_preflight_unmatched_persontime_covid_postest_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_postest_CKD4-5.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_postest_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_postest_CKD4-5.txt
  
  # model
  cox_model_unmatched_persontime_covid_postest_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest CKD4-5 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD4_5, cox_preflight_unmatched_persontime_covid_postest_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_CKD4-5.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_postest_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_preflight_unmatched_persontime_covid_postest_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_postest_RRT.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_postest_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_postest_RRT.txt
  
  # model
  cox_model_unmatched_persontime_covid_postest_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest RRT primary
    needs: [data_selection_VE_primary, table_irr_unmatched_RRT, cox_preflight_unmatched_persontime_covid_postest_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_RRT.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_postest_RRT.txt

  ### unmatched persontime Tx
  # preflight
  cox_preflight_unmatched_persontime_covid_postest_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_postest_Tx.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_postest_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_postest_Tx.txt
  
  # model
  cox_model_unmatched_persontime_covid_postest_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest Tx primary
    needs: [data_selection_VE_primary, table_irr_unmatched_Tx, cox_preflight_unmatched_persontime_covid_postest_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_Tx.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_postest_Tx.txt

  ### unmatched persontime dialysis
  # preflight
  cox_preflight_unmatched_persontime_covid_postest_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_postest_dialysis.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_postest_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_postest_dialysis.txt
  
  # model
  cox_model_unmatched_persontime_covid_postest_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest dialysis primary
    needs: [data_selection_VE_primary, table_irr_unmatched_dialysis, cox_preflight_unmatched_persontime_covid_postest_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_postest_dialysis.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_postest_dialysis.txt


### OUTCOME #2: covid_hosp test

  ### unmatched persontime all
  # preflight
  cox_preflight_unmatched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_hosp_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_hosp_all.txt
  
  # model
  cox_model_unmatched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_persontime_covid_hosp_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_hosp_all.txt

  ### matched persontime all
  # preflight
  cox_preflight_matched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime covid_hosp all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*matched_persontime_covid_hosp_all.rds
        formulas: output/model/VE_primary/formulas*matched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_matched_persontime_covid_hosp_all.txt
  
  # model
  cox_model_matched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime covid_hosp all primary
    needs: [data_selection_VE_primary, table_irr_matched_all, cox_preflight_matched_persontime_covid_hosp_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*matched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*matched_persontime_covid_hosp_all.csv
        logs: output/model/VE_primary/log_cox_model_matched_persontime_covid_hosp_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_preflight_unmatched_calendartime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime covid_hosp all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_calendartime_covid_hosp_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_calendartime_covid_hosp_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_calendartime_covid_hosp_all.txt
  
  # model
  cox_model_unmatched_calendartime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime covid_hosp all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_calendartime_covid_hosp_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_calendartime_covid_hosp_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_calendartime_covid_hosp_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_calendartime_covid_hosp_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_preflight_unmatched_persontime_covid_hosp_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_hosp_CKD3.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_hosp_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_hosp_CKD3.txt
  
  # model
  cox_model_unmatched_persontime_covid_hosp_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp CKD3 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD3, cox_preflight_unmatched_persontime_covid_hosp_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_CKD3.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_hosp_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_preflight_unmatched_persontime_covid_hosp_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_hosp_CKD4-5.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_hosp_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_hosp_CKD4-5.txt
  
  # model
  cox_model_unmatched_persontime_covid_hosp_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp CKD4-5 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD4_5, cox_preflight_unmatched_persontime_covid_hosp_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_CKD4-5.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_hosp_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_preflight_unmatched_persontime_covid_hosp_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_hosp_RRT.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_hosp_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_hosp_RRT.txt
  
  # model
  cox_model_unmatched_persontime_covid_hosp_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp RRT primary
    needs: [data_selection_VE_primary, table_irr_unmatched_RRT, cox_preflight_unmatched_persontime_covid_hosp_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_RRT.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_hosp_RRT.txt

  ### unmatched persontime Tx
  # preflight
  cox_preflight_unmatched_persontime_covid_hosp_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_hosp_Tx.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_hosp_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_hosp_Tx.txt
  
  # model
  cox_model_unmatched_persontime_covid_hosp_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp Tx primary
    needs: [data_selection_VE_primary, table_irr_unmatched_Tx, cox_preflight_unmatched_persontime_covid_hosp_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_Tx.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_hosp_Tx.txt

  ### unmatched persontime dialysis
  # preflight
  cox_preflight_unmatched_persontime_covid_hosp_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_hosp_dialysis.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_hosp_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_hosp_dialysis.txt
  
  # model
  cox_model_unmatched_persontime_covid_hosp_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp dialysis primary
    needs: [data_selection_VE_primary, table_irr_unmatched_dialysis, cox_preflight_unmatched_persontime_covid_hosp_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_hosp_dialysis.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_hosp_dialysis.txt


### OUTCOME #3: covid_death test

  ### unmatched persontime all
  # preflight
  cox_preflight_unmatched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_death_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_death_all.txt
  
  # model
  cox_model_unmatched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_persontime_covid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_death_all.txt

  ### matched persontime all
  # preflight
  cox_preflight_matched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime covid_death all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*matched_persontime_covid_death_all.rds
        formulas: output/model/VE_primary/formulas*matched_persontime_covid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_matched_persontime_covid_death_all.txt
  
  # model
  cox_model_matched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime covid_death all primary
    needs: [data_selection_VE_primary, table_irr_matched_all, cox_preflight_matched_persontime_covid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*matched_persontime_covid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*matched_persontime_covid_death_all.csv
        logs: output/model/VE_primary/log_cox_model_matched_persontime_covid_death_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_preflight_unmatched_calendartime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime covid_death all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_calendartime_covid_death_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_calendartime_covid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_calendartime_covid_death_all.txt
  
  # model
  cox_model_unmatched_calendartime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime covid_death all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_calendartime_covid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_calendartime_covid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_calendartime_covid_death_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_calendartime_covid_death_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_preflight_unmatched_persontime_covid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_death_CKD3.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_death_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_death_CKD3.txt
  
  # model
  cox_model_unmatched_persontime_covid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death CKD3 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD3, cox_preflight_unmatched_persontime_covid_death_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_CKD3.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_death_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_preflight_unmatched_persontime_covid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_death_CKD4-5.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_death_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_death_CKD4-5.txt
  
  # model
  cox_model_unmatched_persontime_covid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death CKD4-5 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD4_5, cox_preflight_unmatched_persontime_covid_death_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_CKD4-5.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_death_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_preflight_unmatched_persontime_covid_death_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_death_RRT.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_death_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_death_RRT.txt
  
  # model
  cox_model_unmatched_persontime_covid_death_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death RRT primary
    needs: [data_selection_VE_primary, table_irr_unmatched_RRT, cox_preflight_unmatched_persontime_covid_death_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_RRT.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_death_RRT.txt

  ### unmatched persontime Tx
  # preflight
  cox_preflight_unmatched_persontime_covid_death_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_death_Tx.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_death_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_death_Tx.txt
  
  # model
  cox_model_unmatched_persontime_covid_death_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death Tx primary
    needs: [data_selection_VE_primary, table_irr_unmatched_Tx, cox_preflight_unmatched_persontime_covid_death_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_Tx.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_death_Tx.txt

  ### unmatched persontime dialysis
  # preflight
  cox_preflight_unmatched_persontime_covid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_covid_death_dialysis.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_covid_death_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_covid_death_dialysis.txt
  
  # model
  cox_model_unmatched_persontime_covid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death dialysis primary
    needs: [data_selection_VE_primary, table_irr_unmatched_dialysis, cox_preflight_unmatched_persontime_covid_death_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_covid_death_dialysis.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_covid_death_dialysis.txt


### OUTCOME #4: noncovid_death test

  ### unmatched persontime all
  # preflight
  cox_preflight_unmatched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_noncovid_death_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_noncovid_death_all.txt
  
  # model
  cox_model_unmatched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_persontime_noncovid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_noncovid_death_all.txt

  ### matched persontime all
  # preflight
  cox_preflight_matched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime noncovid_death all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*matched_persontime_noncovid_death_all.rds
        formulas: output/model/VE_primary/formulas*matched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_matched_persontime_noncovid_death_all.txt
  
  # model
  cox_model_matched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime noncovid_death all primary
    needs: [data_selection_VE_primary, table_irr_matched_all, cox_preflight_matched_persontime_noncovid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*matched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*matched_persontime_noncovid_death_all.csv
        logs: output/model/VE_primary/log_cox_model_matched_persontime_noncovid_death_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_preflight_unmatched_calendartime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime noncovid_death all primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_calendartime_noncovid_death_all.rds
        formulas: output/model/VE_primary/formulas*unmatched_calendartime_noncovid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_calendartime_noncovid_death_all.txt
  
  # model
  cox_model_unmatched_calendartime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime noncovid_death all primary
    needs: [data_selection_VE_primary, table_irr_unmatched_all, cox_preflight_unmatched_calendartime_noncovid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_calendartime_noncovid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_calendartime_noncovid_death_all.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_calendartime_noncovid_death_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_preflight_unmatched_persontime_noncovid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death CKD3 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_noncovid_death_CKD3.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_noncovid_death_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_noncovid_death_CKD3.txt
  
  # model
  cox_model_unmatched_persontime_noncovid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death CKD3 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD3, cox_preflight_unmatched_persontime_noncovid_death_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_CKD3.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_noncovid_death_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_preflight_unmatched_persontime_noncovid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death CKD4-5 primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_noncovid_death_CKD4-5.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_noncovid_death_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_noncovid_death_CKD4-5.txt
  
  # model
  cox_model_unmatched_persontime_noncovid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death CKD4-5 primary
    needs: [data_selection_VE_primary, table_irr_unmatched_CKD4_5, cox_preflight_unmatched_persontime_noncovid_death_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_CKD4-5.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_noncovid_death_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_preflight_unmatched_persontime_noncovid_death_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death RRT primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_noncovid_death_RRT.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_noncovid_death_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_noncovid_death_RRT.txt
  
  # model
  cox_model_unmatched_persontime_noncovid_death_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death RRT primary
    needs: [data_selection_VE_primary, table_irr_unmatched_RRT, cox_preflight_unmatched_persontime_noncovid_death_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_RRT.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_noncovid_death_RRT.txt

  ### unmatched persontime Tx
  # preflight
  cox_preflight_unmatched_persontime_noncovid_death_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death Tx primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_noncovid_death_Tx.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_noncovid_death_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_noncovid_death_Tx.txt
  
  # model
  cox_model_unmatched_persontime_noncovid_death_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death Tx primary
    needs: [data_selection_VE_primary, table_irr_unmatched_Tx, cox_preflight_unmatched_persontime_noncovid_death_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_Tx.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_noncovid_death_Tx.txt
 
  ### unmatched persontime dialysis
  # preflight
  cox_preflight_unmatched_persontime_noncovid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death dialysis primary
    needs: [data_selection_VE_primary]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/data*unmatched_persontime_noncovid_death_dialysis.rds
        formulas: output/model/VE_primary/formulas*unmatched_persontime_noncovid_death_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_primary/log_cox_preflight_unmatched_persontime_noncovid_death_dialysis.txt
  
  # model
  cox_model_unmatched_persontime_noncovid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death dialysis primary
    needs: [data_selection_VE_primary, table_irr_unmatched_dialysis, cox_preflight_unmatched_persontime_noncovid_death_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_primary/modelcox*unmatched_persontime_noncovid_death_dialysis.csv
        logs: output/model/VE_primary/log_cox_model_unmatched_persontime_noncovid_death_dialysis.txt
        
        
  ### summary of primary VE analysis
  cox_VE_primary_summary:
    run: r:latest -e 'rmarkdown::render("analysis/VE/cox_VE_primary_summary.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/")'
    needs:
    - data_selection_VE_primary
    - table_1_VE_all_unmatched
    - table_1_VE_CKD3_unmatched
    - table_1_VE_CKD4_5_unmatched
    - table_1_VE_RRT_unmatched
    - table_1_VE_Tx_unmatched
    - table_1_VE_dialysis_unmatched
    - table_1_VE_all_matched
    - table_irr_unmatched_all
    - table_irr_unmatched_CKD3
    - table_irr_unmatched_CKD4_5
    - table_irr_unmatched_RRT
    - table_irr_unmatched_Tx
    - table_irr_unmatched_dialysis
    - table_irr_matched_all
    - table_irr_matched_CKD3
    - table_irr_matched_CKD4_5
    - table_irr_matched_RRT
    - table_irr_matched_Tx
    - table_irr_matched_dialysis
    - cox_model_unmatched_persontime_covid_postest_VE_all
    - cox_model_matched_persontime_covid_postest_VE_all
    - cox_model_unmatched_calendartime_covid_postest_VE_all
    - cox_model_unmatched_persontime_covid_postest_VE_CKD3
    - cox_model_unmatched_persontime_covid_postest_VE_CKD4_5
    - cox_model_unmatched_persontime_covid_postest_VE_RRT
    - cox_model_unmatched_persontime_covid_postest_VE_Tx
    - cox_model_unmatched_persontime_covid_postest_VE_dialysis
    - cox_model_unmatched_persontime_covid_hosp_VE_all
    - cox_model_matched_persontime_covid_hosp_VE_all
    - cox_model_unmatched_calendartime_covid_hosp_VE_all
    - cox_model_unmatched_persontime_covid_hosp_VE_CKD3
    - cox_model_unmatched_persontime_covid_hosp_VE_CKD4_5
    - cox_model_unmatched_persontime_covid_hosp_VE_RRT
    - cox_model_unmatched_persontime_covid_hosp_VE_Tx
    - cox_model_unmatched_persontime_covid_hosp_VE_dialysis
    - cox_model_unmatched_persontime_covid_death_VE_all
    - cox_model_matched_persontime_covid_death_VE_all
    - cox_model_unmatched_calendartime_covid_death_VE_all
    - cox_model_unmatched_persontime_covid_death_VE_CKD3
    - cox_model_unmatched_persontime_covid_death_VE_CKD4_5
    - cox_model_unmatched_persontime_covid_death_VE_RRT
    - cox_model_unmatched_persontime_covid_death_VE_Tx
    - cox_model_unmatched_persontime_covid_death_VE_dialysis
    - cox_model_unmatched_persontime_noncovid_death_VE_all
    - cox_model_matched_persontime_noncovid_death_VE_all
    - cox_model_unmatched_calendartime_noncovid_death_VE_all
    - cox_model_unmatched_persontime_noncovid_death_VE_CKD3
    - cox_model_unmatched_persontime_noncovid_death_VE_CKD4_5
    - cox_model_unmatched_persontime_noncovid_death_VE_RRT
    - cox_model_unmatched_persontime_noncovid_death_VE_Tx
    - cox_model_unmatched_persontime_noncovid_death_VE_dialysis
    outputs:
      moderately_sensitive:
        html: output/markdown/cox_VE_primary_summary.html
        csv1: output/tables/irr_hr_summary_VE_primary.csv
        csv2: output/tables/irr_hr_summary_VE_primary_subgroups.csv
        csv3: output/model/summary/VE_primary_covariate_estimates_covid_postest.csv
        csv4: output/model/summary/VE_primary_covariate_estimates_covid_hosp.csv
        csv5: output/model/summary/VE_primary_covariate_estimates_covid_death.csv
        csv6: output/model/summary/VE_primary_covariate_estimates_noncovid_death.csv



#############################
### VE boost cohort selection - matched/unmatched
#############################

# Select cohort (single script used for both matched and unmatched analyses)
  data_selection_VE_boost:
    run: r:latest analysis/VE/data_selection_VE_boost.R
    needs: [data_process_VE_boost]
    outputs:
      highly_sensitive:
        data1: output/data/data_cohort_VE_boost.rds
        data2: output/data/data_cohort_VE_boost_matched.rds
        data3: output/lib/outcomes_boost.rds
        data4: output/lib/postboost_list.rds
        csv1: output/data/data_cohort_VE_boost.csv
        csv2: output/data/data_cohort_VE_boost_matched.csv
      moderately_sensitive:
        csv1: output/tables/flowchart_VE_boost.csv
        csv2: output/tables/flowchart_VE_boost_matched.csv

  # Data properties (selected) - booster VE ----
  data_properties_selected_VE_boost:
    run: r:latest analysis/data_properties.R output/data/data_cohort_VE_boost.rds output/data_properties
    needs: [data_selection_VE_boost]
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_cohort_VE_boost*.txt
        
#############################
### VE table 1 - all, CKD3, CKD4-5, RRT - matched,unmatched
#############################

  # Table 1 (all unmatched)
  table_1_VE_boost_all_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_unmatched_all.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_unmatched_all.html
  
  # Table 1 (CKD3 unmatched)
  table_1_VE_boost_CKD3_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_unmatched_CKD3.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_unmatched_CKD3.html
 
  # Table 1 (CKD4-5 unmatched)
  table_1_VE_boost_CKD4_5_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_unmatched_CKD4-5.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_unmatched_CKD4-5.html
 
  # Table 1 (RRT unmatched)
  table_1_VE_boost_RRT_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_unmatched_RRT.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_unmatched_RRT.html
 
  # Table 1 (Tx unmatched)
  table_1_VE_boost_Tx_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_unmatched_Tx.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_unmatched_Tx.html
        
  # Table 1 (dialysis unmatched)
  table_1_VE_boost_dialysis_unmatched:
    run: r:latest analysis/VE/table_1_VE.R unmatched dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_unmatched_dialysis.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_unmatched_dialysis.html
        
  # Table 1 (all matched)
  table_1_VE_boost_all_matched:
    run: r:latest analysis/VE/table_1_VE.R matched all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table1_VE_boost_redacted_matched_all.rds
      moderately_sensitive:
        table: output/tables/table1_VE_boost_redacted_matched_all.html
   
#############################
### IRR - all, CKD3, CKD4-5, RRT - matched,unmatched
#############################
   
  # Table IRR (all unmatched)
  table_irr_boost_unmatched_all:
    run: r:latest analysis/VE/table_irr.R unmatched all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_unmatched_all.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_unmatched_all.csv
        
  # Table IRR (CKD3 unmatched)
  table_irr_boost_unmatched_CKD3:
    run: r:latest analysis/VE/table_irr.R unmatched CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_unmatched_CKD3.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_unmatched_CKD3.csv
 
  # Table IRR (CKD4-5 unmatched)
  table_irr_boost_unmatched_CKD4_5:
    run: r:latest analysis/VE/table_irr.R unmatched CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_unmatched_CKD4-5.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_unmatched_CKD4-5.csv
        
  # Table IRR (RRT unmatched)
  table_irr_boost_unmatched_RRT:
    run: r:latest analysis/VE/table_irr.R unmatched RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_unmatched_RRT.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_unmatched_RRT.csv

  # Table IRR (Tx unmatched)
  table_irr_boost_unmatched_Tx:
    run: r:latest analysis/VE/table_irr.R unmatched Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_unmatched_Tx.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_unmatched_Tx.csv

  # Table IRR (dialysis unmatched)
  table_irr_boost_unmatched_dialysis:
    run: r:latest analysis/VE/table_irr.R unmatched dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_unmatched_dialysis.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_unmatched_dialysis.csv
        
  # Table IRR (all matched)
  table_irr_boost_matched_all:
    run: r:latest analysis/VE/table_irr.R matched all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_matched_all.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_matched_all.csv
        
  # Table IRR (CKD3 matched)
  table_irr_boost_matched_CKD3:
    run: r:latest analysis/VE/table_irr.R matched CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_matched_CKD3.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_matched_CKD3.csv
 
  # Table IRR (CKD4-5 matched)
  table_irr_boost_matched_CKD4_5:
    run: r:latest analysis/VE/table_irr.R matched CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_matched_CKD4-5.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_matched_CKD4-5.csv
        
  # Table IRR (RRT matched)
  table_irr_boost_matched_RRT:
    run: r:latest analysis/VE/table_irr.R matched RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_matched_RRT.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_matched_RRT.csv

  # Table IRR (Tx matched)
  table_irr_boost_matched_Tx:
    run: r:latest analysis/VE/table_irr.R matched Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_matched_Tx.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_matched_Tx.csv

  # Table IRR (dialysis matched)
  table_irr_boost_matched_dialysis:
    run: r:latest analysis/VE/table_irr.R matched dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/tables/table_irr_boost_redacted_matched_dialysis.rds
      moderately_sensitive:
        csv: output/tables/table_irr_boost_redacted_matched_dialysis.csv
        
#############################
### Cox models for booster dose - preflight then model
### Outcomes (4): postest, hosp, death, non-Covid death
### Populations (2): unmatched, matched
### Timescales (3): persontime, calendartime
### Subsets: all, CKD3, CKD4-5, RRT, Tx, dialysis (unmatched)
#############################

### OUTCOME #1: covid_postest test

  ### unmatched persontime all
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_postest_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_postest_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_postest_all.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_persontime_covid_postest_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_postest_all.txt

  ### matched persontime all
  # preflight
  cox_boost_preflight_matched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime covid_postest all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*matched_persontime_covid_postest_all.rds
        formulas: output/model/VE_boost/formulas*matched_persontime_covid_postest_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_matched_persontime_covid_postest_all.txt
  
  # model
  cox_boost_model_matched_persontime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime covid_postest all boost
    needs: [data_selection_VE_boost, table_irr_boost_matched_all, cox_boost_preflight_matched_persontime_covid_postest_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*matched_persontime_covid_postest_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*matched_persontime_covid_postest_all.csv
        logs: output/model/VE_boost/log_cox_model_matched_persontime_covid_postest_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_boost_preflight_unmatched_calendartime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime covid_postest all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_calendartime_covid_postest_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_calendartime_covid_postest_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_calendartime_covid_postest_all.txt
  
  # model
  cox_boost_model_unmatched_calendartime_covid_postest_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime covid_postest all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_calendartime_covid_postest_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_calendartime_covid_postest_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_calendartime_covid_postest_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_calendartime_covid_postest_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_postest_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_postest_CKD3.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_postest_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_postest_CKD3.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_postest_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest CKD3 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD3, cox_boost_preflight_unmatched_persontime_covid_postest_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_CKD3.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_postest_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_postest_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_postest_CKD4-5.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_postest_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_postest_CKD4-5.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_postest_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest CKD4-5 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD4_5, cox_boost_preflight_unmatched_persontime_covid_postest_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_CKD4-5.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_postest_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_postest_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_postest_RRT.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_postest_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_postest_RRT.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_postest_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest RRT boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_RRT, cox_boost_preflight_unmatched_persontime_covid_postest_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_RRT.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_postest_RRT.txt

  ### unmatched persontime Tx
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_postest_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_postest_Tx.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_postest_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_postest_Tx.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_postest_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest Tx boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_Tx, cox_boost_preflight_unmatched_persontime_covid_postest_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_Tx.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_postest_Tx.txt

  ### unmatched persontime dialysis
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_postest_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_postest dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_postest_dialysis.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_postest_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_postest_dialysis.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_postest_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_postest dialysis boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_dialysis, cox_boost_preflight_unmatched_persontime_covid_postest_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_postest_dialysis.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_postest_dialysis.txt


### OUTCOME #2: covid_hosp test

  ### unmatched persontime all
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_hosp_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_hosp_all.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_persontime_covid_hosp_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_hosp_all.txt

  ### matched persontime all
  # preflight
  cox_boost_preflight_matched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime covid_hosp all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*matched_persontime_covid_hosp_all.rds
        formulas: output/model/VE_boost/formulas*matched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_matched_persontime_covid_hosp_all.txt
  
  # model
  cox_boost_model_matched_persontime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime covid_hosp all boost
    needs: [data_selection_VE_boost, table_irr_boost_matched_all, cox_boost_preflight_matched_persontime_covid_hosp_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*matched_persontime_covid_hosp_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*matched_persontime_covid_hosp_all.csv
        logs: output/model/VE_boost/log_cox_model_matched_persontime_covid_hosp_all.txt

  ### unmatched calendartime all
  # preflight
  cox_boost_preflight_unmatched_calendartime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime covid_hosp all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_calendartime_covid_hosp_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_calendartime_covid_hosp_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_calendartime_covid_hosp_all.txt
  
  # model
  cox_boost_model_unmatched_calendartime_covid_hosp_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime covid_hosp all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_calendartime_covid_hosp_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_calendartime_covid_hosp_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_calendartime_covid_hosp_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_calendartime_covid_hosp_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_hosp_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_hosp_CKD3.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_hosp_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_hosp_CKD3.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_hosp_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp CKD3 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD3, cox_boost_preflight_unmatched_persontime_covid_hosp_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_CKD3.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_hosp_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_hosp_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_hosp_CKD4-5.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_hosp_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_hosp_CKD4-5.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_hosp_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp CKD4-5 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD4_5, cox_boost_preflight_unmatched_persontime_covid_hosp_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_CKD4-5.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_hosp_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_hosp_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_hosp_RRT.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_hosp_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_hosp_RRT.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_hosp_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp RRT boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_RRT, cox_boost_preflight_unmatched_persontime_covid_hosp_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_RRT.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_hosp_RRT.txt
        
  ### unmatched persontime Tx
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_hosp_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_hosp_Tx.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_hosp_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_hosp_Tx.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_hosp_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp Tx boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_Tx, cox_boost_preflight_unmatched_persontime_covid_hosp_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_Tx.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_hosp_Tx.txt
        
  ### unmatched persontime dialysis
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_hosp_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_hosp dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_hosp_dialysis.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_hosp_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_hosp_dialysis.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_hosp_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_hosp dialysis boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_dialysis, cox_boost_preflight_unmatched_persontime_covid_hosp_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_hosp_dialysis.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_hosp_dialysis.txt



### OUTCOME #3: covid_death test

  ### unmatched persontime all
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_death_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_death_all.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_persontime_covid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_death_all.txt

  ### matched persontime all
  # preflight
  cox_boost_preflight_matched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime covid_death all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*matched_persontime_covid_death_all.rds
        formulas: output/model/VE_boost/formulas*matched_persontime_covid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_matched_persontime_covid_death_all.txt
  
  # model
  cox_boost_model_matched_persontime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime covid_death all boost
    needs: [data_selection_VE_boost, table_irr_boost_matched_all, cox_boost_preflight_matched_persontime_covid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*matched_persontime_covid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*matched_persontime_covid_death_all.csv
        logs: output/model/VE_boost/log_cox_model_matched_persontime_covid_death_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_boost_preflight_unmatched_calendartime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime covid_death all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_calendartime_covid_death_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_calendartime_covid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_calendartime_covid_death_all.txt
  
  # model
  cox_boost_model_unmatched_calendartime_covid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime covid_death all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_calendartime_covid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_calendartime_covid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_calendartime_covid_death_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_calendartime_covid_death_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_death_CKD3.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_death_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_death_CKD3.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death CKD3 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD3, cox_boost_preflight_unmatched_persontime_covid_death_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_CKD3.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_death_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_death_CKD4-5.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_death_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_death_CKD4-5.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death CKD4-5 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD4_5, cox_boost_preflight_unmatched_persontime_covid_death_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_CKD4-5.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_death_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_death_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_death_RRT.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_death_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_death_RRT.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_death_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death RRT boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_RRT, cox_boost_preflight_unmatched_persontime_covid_death_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_RRT.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_death_RRT.txt
        
  ### unmatched persontime Tx
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_death_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_death_Tx.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_death_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_death_Tx.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_death_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death Tx boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_Tx, cox_boost_preflight_unmatched_persontime_covid_death_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_Tx.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_death_Tx.txt

  ### unmatched persontime dialysis
  # preflight
  cox_boost_preflight_unmatched_persontime_covid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime covid_death dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_covid_death_dialysis.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_covid_death_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_covid_death_dialysis.txt
  
  # model
  cox_boost_model_unmatched_persontime_covid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime covid_death dialysis boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_dialysis, cox_boost_preflight_unmatched_persontime_covid_death_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_covid_death_dialysis.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_covid_death_dialysis.txt


### OUTCOME #4: noncovid_death test

  ### unmatched persontime all
  # preflight
  cox_boost_preflight_unmatched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_noncovid_death_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_noncovid_death_all.txt
  
  # model
  cox_boost_model_unmatched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_persontime_noncovid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_noncovid_death_all.txt

  ### matched persontime all
  # preflight
  cox_boost_preflight_matched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R matched persontime noncovid_death all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*matched_persontime_noncovid_death_all.rds
        formulas: output/model/VE_boost/formulas*matched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_matched_persontime_noncovid_death_all.txt
  
  # model
  cox_boost_model_matched_persontime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R matched persontime noncovid_death all boost
    needs: [data_selection_VE_boost, table_irr_boost_matched_all, cox_boost_preflight_matched_persontime_noncovid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*matched_persontime_noncovid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*matched_persontime_noncovid_death_all.csv
        logs: output/model/VE_boost/log_cox_model_matched_persontime_noncovid_death_all.txt
        
  ### unmatched calendartime all
  # preflight
  cox_boost_preflight_unmatched_calendartime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched calendartime noncovid_death all boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_calendartime_noncovid_death_all.rds
        formulas: output/model/VE_boost/formulas*unmatched_calendartime_noncovid_death_all.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_calendartime_noncovid_death_all.txt
  
  # model
  cox_boost_model_unmatched_calendartime_noncovid_death_VE_all:
    run: r:latest analysis/VE/cox_model_VE.R unmatched calendartime noncovid_death all boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_all, cox_boost_preflight_unmatched_calendartime_noncovid_death_VE_all]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_calendartime_noncovid_death_all.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_calendartime_noncovid_death_all.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_calendartime_noncovid_death_all.txt

  ### unmatched persontime CKD3
  # preflight
  cox_boost_preflight_unmatched_persontime_noncovid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death CKD3 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_noncovid_death_CKD3.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_noncovid_death_CKD3.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_noncovid_death_CKD3.txt
  
  # model
  cox_boost_model_unmatched_persontime_noncovid_death_VE_CKD3:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death CKD3 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD3, cox_boost_preflight_unmatched_persontime_noncovid_death_VE_CKD3]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_CKD3.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_CKD3.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_noncovid_death_CKD3.txt

  ### unmatched persontime CKD4-5
  # preflight
  cox_boost_preflight_unmatched_persontime_noncovid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death CKD4-5 boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_noncovid_death_CKD4-5.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_noncovid_death_CKD4-5.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_noncovid_death_CKD4-5.txt
  
  # model
  cox_boost_model_unmatched_persontime_noncovid_death_VE_CKD4_5:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death CKD4-5 boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_CKD4_5, cox_boost_preflight_unmatched_persontime_noncovid_death_VE_CKD4_5]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_CKD4-5.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_CKD4-5.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_noncovid_death_CKD4-5.txt

  ### unmatched persontime RRT
  # preflight
  cox_boost_preflight_unmatched_persontime_noncovid_death_VE_RRT:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death RRT boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_noncovid_death_RRT.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_noncovid_death_RRT.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_noncovid_death_RRT.txt
  
  # model
  cox_boost_model_unmatched_persontime_noncovid_death_VE_RRT:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death RRT boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_RRT, cox_boost_preflight_unmatched_persontime_noncovid_death_VE_RRT]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_RRT.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_RRT.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_noncovid_death_RRT.txt
        
  ### unmatched persontime Tx
  # preflight
  cox_boost_preflight_unmatched_persontime_noncovid_death_VE_Tx:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death Tx boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_noncovid_death_Tx.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_noncovid_death_Tx.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_noncovid_death_Tx.txt
  
  # model
  cox_boost_model_unmatched_persontime_noncovid_death_VE_Tx:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death Tx boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_Tx, cox_boost_preflight_unmatched_persontime_noncovid_death_VE_Tx]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_Tx.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_Tx.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_noncovid_death_Tx.txt

  ### unmatched persontime dialysis
  # preflight
  cox_boost_preflight_unmatched_persontime_noncovid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_preflight_VE.R unmatched persontime noncovid_death dialysis boost
    needs: [data_selection_VE_boost]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/data*unmatched_persontime_noncovid_death_dialysis.rds
        formulas: output/model/VE_boost/formulas*unmatched_persontime_noncovid_death_dialysis.rds
      moderately_sensitive:
        logs: output/model/VE_boost/log_cox_preflight_unmatched_persontime_noncovid_death_dialysis.txt
  
  # model
  cox_boost_model_unmatched_persontime_noncovid_death_VE_dialysis:
    run: r:latest analysis/VE/cox_model_VE.R unmatched persontime noncovid_death dialysis boost
    needs: [data_selection_VE_boost, table_irr_boost_unmatched_dialysis, cox_boost_preflight_unmatched_persontime_noncovid_death_VE_dialysis]
    outputs:
      highly_sensitive:
        data: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_dialysis.rds
      moderately_sensitive:
        csv: output/model/VE_boost/modelcox*unmatched_persontime_noncovid_death_dialysis.csv
        logs: output/model/VE_boost/log_cox_model_unmatched_persontime_noncovid_death_dialysis.txt


  ### summary of booster VE analysis
  cox_VE_boost_summary:
    run: r:latest -e 'rmarkdown::render("analysis/VE/cox_VE_boost_summary.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/")'
    needs:
    - data_selection_VE_boost
    - table_1_VE_boost_all_unmatched
    - table_1_VE_boost_all_matched
    - table_1_VE_boost_CKD3_unmatched
    - table_1_VE_boost_CKD4_5_unmatched
    - table_1_VE_boost_RRT_unmatched
    - table_1_VE_boost_Tx_unmatched
    - table_1_VE_boost_dialysis_unmatched
    - table_irr_boost_unmatched_all
    - table_irr_boost_unmatched_CKD3
    - table_irr_boost_unmatched_CKD4_5
    - table_irr_boost_unmatched_RRT
    - table_irr_boost_unmatched_Tx
    - table_irr_boost_unmatched_dialysis
    - table_irr_boost_matched_all
    - table_irr_boost_matched_CKD3
    - table_irr_boost_matched_CKD4_5
    - table_irr_boost_matched_RRT
    - table_irr_boost_matched_Tx
    - table_irr_boost_matched_dialysis
    - cox_boost_model_unmatched_persontime_covid_postest_VE_all
    - cox_boost_model_matched_persontime_covid_postest_VE_all
    - cox_boost_model_unmatched_calendartime_covid_postest_VE_all
    - cox_boost_model_unmatched_persontime_covid_postest_VE_CKD3
    - cox_boost_model_unmatched_persontime_covid_postest_VE_CKD4_5
    - cox_boost_model_unmatched_persontime_covid_postest_VE_RRT
    - cox_boost_model_unmatched_persontime_covid_postest_VE_Tx
    - cox_boost_model_unmatched_persontime_covid_postest_VE_dialysis
    - cox_boost_model_unmatched_persontime_covid_hosp_VE_all
    - cox_boost_model_matched_persontime_covid_hosp_VE_all
    - cox_boost_model_unmatched_calendartime_covid_hosp_VE_all
    - cox_boost_model_unmatched_persontime_covid_hosp_VE_CKD3
    - cox_boost_model_unmatched_persontime_covid_hosp_VE_CKD4_5
    - cox_boost_model_unmatched_persontime_covid_hosp_VE_RRT
    - cox_boost_model_unmatched_persontime_covid_hosp_VE_Tx
    - cox_boost_model_unmatched_persontime_covid_hosp_VE_dialysis
    - cox_boost_model_unmatched_persontime_covid_death_VE_all
    - cox_boost_model_matched_persontime_covid_death_VE_all
    - cox_boost_model_unmatched_calendartime_covid_death_VE_all
    - cox_boost_model_unmatched_persontime_covid_death_VE_CKD3
    - cox_boost_model_unmatched_persontime_covid_death_VE_CKD4_5
    - cox_boost_model_unmatched_persontime_covid_death_VE_RRT
    - cox_boost_model_unmatched_persontime_covid_death_VE_Tx
    - cox_boost_model_unmatched_persontime_covid_death_VE_dialysis
    - cox_boost_model_unmatched_persontime_noncovid_death_VE_all
    - cox_boost_model_matched_persontime_noncovid_death_VE_all
    - cox_boost_model_unmatched_calendartime_noncovid_death_VE_all
    - cox_boost_model_unmatched_persontime_noncovid_death_VE_CKD3
    - cox_boost_model_unmatched_persontime_noncovid_death_VE_CKD4_5
    - cox_boost_model_unmatched_persontime_noncovid_death_VE_RRT
    - cox_boost_model_unmatched_persontime_noncovid_death_VE_Tx
    - cox_boost_model_unmatched_persontime_noncovid_death_VE_dialysis
    outputs:
      moderately_sensitive:
        html: output/markdown/cox_VE_boost_summary.html
        csv1: output/tables/irr_hr_summary_VE_boost.csv
        csv2: output/tables/irr_hr_summary_VE_boost_subgroups.csv
        csv3: output/model/summary/VE_boost_covariate_estimates_covid_postest.csv
        csv4: output/model/summary/VE_boost_covariate_estimates_covid_hosp.csv
        csv5: output/model/summary/VE_boost_covariate_estimates_covid_death.csv
        csv6: output/model/summary/VE_boost_covariate_estimates_noncovid_death.csv

  ### summary of primary/booster VE analysis - follow-up time
  follow_up_summary:
    run: r:latest -e 'rmarkdown::render("analysis/VE/follow_up_summary.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/")'
    needs: [data_selection_VE_primary, data_selection_VE_boost]
    outputs:
      moderately_sensitive:
        html: output/markdown/follow_up_summary.html

  ### summary of primary/booster VE analysis
  cox_VE_combined_summary:
    run: r:latest -e 'rmarkdown::render("analysis/VE/cox_VE_combined_summary.Rmd", knit_root_dir = "/workspace", output_dir="/workspace/output/markdown/")'
    needs: [data_selection_VE_primary, data_selection_VE_boost, cox_VE_primary_summary, cox_VE_boost_summary]
    outputs:
      moderately_sensitive:
        html: output/markdown/cox_VE_combined_summary.html
